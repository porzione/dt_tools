#!/usr/bin/env ruby
# frozen_string_literal: true

require_relative 'models'

FilmRoll.select(:id, :folder).order(:folder).all do |r|
  unless Dir.exist?(r.folder)
    warn "no r.folder:#{r.folder}"
    next
  end
  Dir.entries(r.folder).each do |file|
    next unless File.file?("#{r.folder}/#{file}")
    next if file.match?(/\.(xmp|pto|pp3|xcf|orig|txt)$/i)

    if Image.where(film_id: r.id, filename: file).count.zero?
      puts "#{r.folder}/#{file}"
    end
  end
end
